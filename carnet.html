<html>
  <head>
    <title>liste</title>
    <script language="JavaScript">
      function ajout() {
        np = document.f1.znp.value;
        adr = document.f1.zadr.value;
        var taille = document.f1.carnet.options.length;
        var nouveau = true;
        if (taille != 0) {
          for (i = 0; i < taille; i++) {
            elt = document.f1.carnet.options[i].text;
            if (elt == np) {
              nouveau = false;
              alert("contact deja existant");
              break;
            }
          }
        }
        if (nouveau) {
          nelt = new Option(np, adr);
          document.f1.carnet.options[taille] = nelt;
        }
      }
      function supp() {
        sel = document.f1.carnet.options.selectedIndex;
        if (sel == -1) alert("veuillez sélectionner un élément SVP");
        else {
          document.f1.carnet.options[sel] = null;
        }
      }
      function adresse() {
        sel = document.f1.carnet.options.selectedIndex;
        if (sel == -1) alert("veuillez sélectionner un élément SVP");
        else {
          np = document.f1.carnet.options[sel].text;
          adr = document.f1.carnet.options[sel].value;
          alert("l'adresse mail de:" + np + " est: " + adr);
        }
      }
    </script>
  </head>
  <body>
    <p align="center"><font color="red" size="6">CARNET D'ADRESSES</font></p>
    <form name="f1">
      Nom et Prénom: <input type="text" name="znp" size="30" /><br /><br />
      Adresse E-mail:<input type="text" name="zadr" size="30" /><br /><br />
      <table>
        <tr>
          <td>
            <input type="button" name="b1" value="Ajouter" OnClick="ajout()" />
          </td>
          <td>
            <input type="button" name="b2" value="Supprimer" OnClick="supp()" />
          </td>
          <td>
            <input
              type="button"
              name="b3"
              value="Retrouver Adresse E-mail"
              OnClick="adresse()"
            />
          </td>
        </tr>
      </table>
      <select name="carnet" size="5"></select>
    </form>
  </body>
</html>
